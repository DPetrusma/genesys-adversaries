"use strict";System.register(["react","lib/dispatcher","lib/config","lib/dom"],function(_export,_context){"use strict";var React,dispatcher,CONFIG,parent,_createClass,Tabs;function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}return{setters:[function(_react){React=_react.default},function(_libDispatcher){dispatcher=_libDispatcher.default},function(_libConfig){CONFIG=_libConfig},function(_libDom){parent=_libDom.parent}],execute:function(){_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();Tabs=function(_React$Component){_inherits(Tabs,_React$Component);function Tabs(props){_classCallCheck(this,Tabs);var _this=_possibleConstructorReturn(this,(Tabs.__proto__||Object.getPrototypeOf(Tabs)).call(this,props));_this.state={active:-1};return _this}_createClass(Tabs,[{key:"componentWillUpdate",value:function componentWillUpdate(nextProps,nextState){if(nextProps.selectedIndex!==this.props.selectedIndex){this.closeMenu()}}},{key:"add",value:function add(){dispatcher.dispatch(CONFIG.TAB_ADD)}},{key:"remove",value:function remove(evt){this.closeMenu();dispatcher.dispatch(CONFIG.TAB_REMOVE,this._getIndex(parent(evt.target,"li")))}},{key:"rename",value:function rename(evt){dispatcher.dispatch(CONFIG.TAB_RENAME,this._getIndex(parent(evt.target,"li")),evt.target.value)}},{key:"changeColour",value:function changeColour(evt){this.closeMenu();dispatcher.dispatch(CONFIG.TAB_COLOUR,this._getIndex(parent(evt.target,"li")),evt.target.getAttribute("data-colour"))}},{key:"closeMenu",value:function closeMenu(){this.setState({active:-1})}},{key:"toggleMenu",value:function toggleMenu(evt){var index=this._getIndex(evt.target);this.setState({active:index===this.state.active?-1:index})}},{key:"view",value:function view(evt){dispatcher.dispatch(CONFIG.TAB_CHANGE,this._getIndex(evt.target))}},{key:"_getIndex",value:function _getIndex(target){var node=parent(target,"li");if(node){return parseInt(node.getAttribute("data-index"),10)}return-1}},{key:"render",value:function render(){var _this2=this;var tabs=this.props.tabs;var colours=CONFIG.COLOURS.map(function(c){return React.createElement("li",{key:c},React.createElement("div",{className:"colour tab-"+c,"data-colour":c,onClick:_this2.changeColour.bind(_this2)},"\xA0"))});return React.createElement("ul",{id:"tabs"},tabs.map(function(t,i){return React.createElement("li",{key:i,className:i==_this2.props.selectedIndex?"active ":null,"data-index":i},React.createElement("span",{className:"btn",onClick:_this2.view.bind(_this2)},t.colour?React.createElement("span",{className:"square tab-"+t.colour}):null,t.tabName),React.createElement("small",{className:"btn tools",onClick:_this2.toggleMenu.bind(_this2)},React.createElement("svg",null,React.createElement("use",{xlinkHref:"#icon-cog"}))),React.createElement("ul",{className:_this2.state.active==i?"active":""},React.createElement("li",null,React.createElement("input",{type:"text",value:t.tabName,onChange:_this2.rename.bind(_this2)})),colours,React.createElement("li",{onClick:_this2.remove.bind(_this2)},React.createElement("div",{className:"btn"},React.createElement("svg",null,React.createElement("use",{xlinkHref:"#icon-delete"}))," Remove"))))}),React.createElement("li",{className:"tools"},React.createElement("small",{className:"btn",onClick:this.add.bind(this)},React.createElement("svg",null,React.createElement("use",{xlinkHref:"#icon-plus"}))," Add")))}}]);return Tabs}(React.Component);_export("default",Tabs)}}});