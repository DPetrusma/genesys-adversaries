"use strict";System.register(["react","lib/utils","lib/config"],function(_export,_context){"use strict";var React,dice,minionSkill,CONFIG,_createClass,PanelSkill;function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}return{setters:[function(_react){React=_react.default},function(_libUtils){dice=_libUtils.dice;minionSkill=_libUtils.minionSkill},function(_libConfig){CONFIG=_libConfig}],execute:function(){_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();PanelSkill=function(_React$Component){_inherits(PanelSkill,_React$Component);function PanelSkill(props){_classCallCheck(this,PanelSkill);var _this=_possibleConstructorReturn(this,(PanelSkill.__proto__||Object.getPrototypeOf(PanelSkill)).call(this,props));_this.state={showAll:false,minions:0};return _this}_createClass(PanelSkill,[{key:"componentWillUpdate",value:function componentWillUpdate(nextProps,nextState){if(nextProps.character!==this.props.character){this.setState({showAll:false,minions:0})}}},{key:"toggleSkills",value:function toggleSkills(){this.setState({showAll:!this.state.showAll})}},{key:"increaseMinions",value:function increaseMinions(){this.props.setMinions(this.props.minions+1)}},{key:"decreaseMinions",value:function decreaseMinions(){this.props.setMinions(this.props.minions-1)}},{key:"resetMinions",value:function resetMinions(){this.props.setMinions(1)}},{key:"isMinion",value:function isMinion(){return this.props.character.type==CONFIG.MINION}},{key:"render",value:function render(){var _this2=this;if(this.props.character==null){return null}var character=this.props.character;var skills=[];var allSkills=this.props.skills.all();var characterSkills={};if(Array.isArray(character.skills)){character.skills.forEach(function(s){return characterSkills[s]=0})}else{characterSkills=character.skills}allSkills.forEach(function(skill){if(_this2.state.showAll||skill.name in characterSkills){if(_this2.state.showAll&&"hide"in skill&&skill.hide&&!(skill.name in characterSkills)){return}var stat=character.characteristics[skill.characteristic];var value=characterSkills[skill.name]||0;if(_this2.isMinion()){value=minionSkill(_this2.props.aliveMinions,skill.name,characterSkills)}skills.push({"id":skill.id,"name":skill.name,"value":value,"characteristic":skill.characteristic,"stat":stat,"icons":dice(stat,value),"hasRank":_this2.state.showAll&&skill.name in characterSkills})}});return React.createElement("div",{className:"info"},React.createElement("h2",null,"Skills ",this.isMinion()?React.createElement("small",null,"(Group Only)"):null),React.createElement("div",{id:"show-all"},React.createElement("small",{className:"btn",onClick:this.toggleSkills.bind(this)},this.state.showAll?React.createElement("svg",null,React.createElement("use",{xlinkHref:"#icon-checkbox-checked"})):React.createElement("svg",null,React.createElement("use",{xlinkHref:"#icon-checkbox-unchecked"}))," Show all")),skills.length==0?React.createElement("p",null,"\u2013"):React.createElement("table",{className:"skills"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null,"Skill"),React.createElement("th",null,"Characteristic"),!this.isMinion()?React.createElement("th",null,"Rank"):null,React.createElement("th",null,"Roll",this.isMinion()?React.createElement("span",null,React.createElement("small",null," (for ",this.props.minions,")"),React.createElement("span",{className:"pull-right"},React.createElement("span",{className:"link",onClick:this.increaseMinions.bind(this),title:"Add Minion"},"\xA0+\xA0")," /",React.createElement("span",{className:"link",onClick:this.decreaseMinions.bind(this),title:"Remove Minion"},"\xA0-\xA0")," /",React.createElement("span",{className:"link",onClick:this.resetMinions.bind(this),title:"One Minion"},"\xA01\xA0"))):null))),React.createElement("tbody",null,skills.map(function(s){return React.createElement("tr",{key:s.id},React.createElement("td",null,s.hasRank?React.createElement("strong",null,s.name):s.name),React.createElement("td",null,React.createElement("small",null,s.characteristic)),!_this2.isMinion()?React.createElement("td",null,s.value):null,React.createElement("td",{dangerouslySetInnerHTML:s.icons}))}))))}}]);return PanelSkill}(React.Component);_export("default",PanelSkill)}}});